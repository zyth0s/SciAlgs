import SciAlgs.NumQuad: gauss_chebyshev1st

# Tested against https://keisan.casio.com/exec/system/1281438499
@testset "Gauss-Chebyshev 1st order" begin
  a = BigFloat(-1); b = BigFloat(1)
  for n in 1:4
    x, w = gauss_chebyshev1st(a,b,n)
    #@test isapprox(sum(w),b-a) "$(sum(w)) ≠ $(b-a)"
    if n == 1
      @test isapprox(x[1], (a+b)/2) #"$(x[1]) ≠ $((a+b)/2)"
      #@test isapprox(w[1], ) "$(w[1]) ≠ $(b-a)"
    elseif n == 2
      @test isapprox(x[1], -0.7071067811865475244008) #"$(x[1]) ≠ -0.7071067811865475244008"
      @test isapprox(x[2],  0.7071067811865475244008) #"$(x[2]) ≠  0.7071067811865475244008"
      @test isapprox(w[1],  1.110720734539591561754 ) #"$(w[1]) ≠  1.110720734539591561754"
      @test isapprox(w[2],  1.110720734539591561754 ) #"$(w[1]) ≠  1.110720734539591561754"
    elseif n == 3
      @test isapprox(x[1], -0.8660254037844386467637) #"$(x[1]) ≠ -0.8660254037844386467637"
      @test isapprox(x[2]+1.0,  1.000000000000000000) #"$(x[2]) ≠  0.0000000000000000000000"
      @test isapprox(x[3],  0.8660254037844386467637) #"$(x[2]) ≠  0.8660254037844386467637"
      @test isapprox(w[1],  0.523598775598298873077) #"$(w[1]) ≠ 0.523598775598298873077"
      @test isapprox(w[2],  1.047197551196597746154) #"$(w[1]) ≠ 1.047197551196597746154"
      @test isapprox(w[3],  0.523598775598298873077) #"$(w[1]) ≠ 0.523598775598298873077"
    elseif n == 4
      @test isapprox(x[1], -0.9238795325112867561282) #"$(x[1]) ≠ -0.9238795325112867561282"
      @test isapprox(x[2], -0.3826834323650897717285) #"$(x[2]) ≠ -0.3826834323650897717285"
      @test isapprox(x[3],  0.3826834323650897717285) #"$(w[1]) ≠  0.3826834323650897717285"
      @test isapprox(x[4],  0.9238795325112867561282) #"$(w[1]) ≠  0.9238795325112867561282"
      @test isapprox(w[1], 0.3005588649421731353571) #"$(x[2]) ≠ 0.3005588649421731353571"
      @test isapprox(w[2], 0.7256132880348577535144) #"$(w[1]) ≠ 0.7256132880348577535144"
      @test isapprox(w[3], 0.7256132880348577535144) #"$(w[1]) ≠ 0.7256132880348577535144"
      @test isapprox(w[4], 0.3005588649421731353571) #"$(w[1]) ≠ 0.3005588649421731353571"
    end
  end
end
