
using SciAlgs: xyzint

@testset "Cartesian to internal coordinates" begin


   xyz = zeros(3,8)
   xyz[:,1] = [ 0.77389  -0.01480 -0.00796]
   xyz[:,2] = [-0.77389   0.01480 -0.00796]
   xyz[:,3] = [-1.18197  -0.85433 -0.51417]
   xyz[:,4] = [-1.14844   0.89890 -0.51417]
   xyz[:,5] = [-1.16521   0.02228  1.00446]
   xyz[:,6] = [ 1.18197   0.85433 -0.51417]
   xyz[:,7] = [ 1.14844  -0.89890 -0.51417]
   xyz[:,8] = [ 1.16521  -0.02228  1.00446]
   #elnames = ["C","C","H","H","H","H","H","H"]

   geo, na, nb, nc = xyzint(xyz)

   # C     0     0.00000    0     0.00000    0     0.00000
   # C     1     1.54806    0     0.00000    0     0.00000
   # H     2     1.08543    1   111.13591    0     0.00000
   # H     2     1.08543    1   111.13582    3  -119.99965
   # H     2     1.08544    1   111.13601    3   120.00001
   # H     1     1.08543    2   111.13591    3   119.99957
   # H     1     1.08543    2   111.13582    3     0.00000
   # H     1     1.08544    2   111.13601    3  -120.00042
   na_ref = [0, 1, 2, 2, 2, 1, 1, 1]
   nb_ref = [0, 0, 1, 1, 1, 2, 2, 2]
   nc_ref = [0, 0, 0, 3, 3, 3, 3, 3]
   geo_ref = [0.00000     0.00000     0.00000;
              1.54806     0.00000     0.00000;
              1.08543   111.13591     0.00000;
              1.08543   111.13582  -119.99965;
              1.08544   111.13601   120.00001;
              1.08543   111.13591   119.99957;
              1.08543   111.13582     0.00000;
              1.08544   111.13601  -120.00042]
   @test  na == na_ref
   @test  nb == nb_ref
   @test  nc == nc_ref
   @test  isapprox(geo, transpose(geo_ref), atol=1e-4)
end

