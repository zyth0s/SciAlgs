# When two black holes collapse a lighter
# black hole remains, and energy is radiated as
# gravitational waves. How much energy is radiated?
# Ethan Siegel discusses it in 
# https://www.forbes.com/sites/startswithabang/2021/05/05/why-28--47--72-not-75-for-black-holes/
# and gives a simple rule.

using Interpolations

@doc """
    energy_radiated_black_hole_collapse(m1, m2; alg=:Varma)

Calculate how much energy is radiated when two black holes
merge using data from Vijay Varma.
"""
function energy_radiated_black_hole_collapse(m1, m2; alg=:Varma)
   # Data extracted from figure in Siegel's article
   # with https://apps.automeris.io/wpd/
   # How-to: 
   # 1) Indicate axes with 4 points
   # 2) Pick foreground color
   # 3) Alg=Averaging window; Distance = 10; ΔX = 10; ΔY = 10
   data = [
           0.9920126936316696  9.708580802081565;
           1.0225365748709123  9.856643121782906;
           1.040850903614458   9.947888030997227;
           1.0896891135972462 10.141131427116918;
           1.1141082185886404 10.214159454720289;
           1.1385273235800346 10.341070014464295;
           1.1690512048192772 10.459726228859099;
           1.1873655335628228 10.491023954974828;
           1.2178894148020656 10.584917133322019;
           1.2362037435456112 10.652327620340516;
           1.2728324010327023 10.75504836246394 ;
           1.303356282271945  10.815135984077154;
           1.3277753872633393 10.896690635782566;
           1.3644040447504304 10.960489846710786;
           1.4010327022375217 11.036326644606595;
           1.4437661359724614 11.125003535267831;
           1.4926043459552498 11.218094207817185;
           1.5353377796901895 11.278884022003506;
           1.5780712134251293 11.331247525312516;
           1.6350491250717156 11.40267054132021 ;
           1.6635380808950089 11.439585808020816;
           1.7398477839931155 11.513015088523106;
           1.8059828600114747 11.560764183494541;
           1.9174967728055083 11.622557129928163;
           2.062383462421113  11.667096201708242;
           2.1702345094664373 11.685152582159624;
           2.347273020654045  11.680337547372588;
           2.5914640705679868 11.638607245884948;
           2.8722837779690193 11.555146642909667;
           2.982169750430293  11.514820726568244;
           3.1635688160806494 11.449215877594886;
           3.348456325301205  11.37097156230556 ;
           3.474621701090075  11.322419961536285;
           3.6366017641996566 11.252280954805135;
           3.7806744836488817 11.189203999094971;
           3.913148128227195  11.130219822953787;
           4.053557981927712  11.077254440296397;
           4.154286790017212  11.030307851122801;
           4.337430077452668  10.959286088014027;
           4.45952560240964   10.905919452457718;
           4.6243545611015495 10.843725253125177;
           4.829882028112451  10.763875926240171;
           4.986978270223753  10.69903345777476 ;
           5.114771586345382  10.649117597149159;
           5.2470417383821    10.59545002191866 ;
           5.358962636259324  10.555224418801968;
           5.501407415375789  10.49985151875106 ;
           5.613328313253012  10.45731871146558 ;
           5.7690001075731505 10.400140173369534;
           5.896182946069995  10.352992957746478;
           6.049209337349399  10.29842256349341 ;
           6.187177280550776  10.247864698229538;
           6.361773881239243  10.185269245998077;
           6.445612808376364  10.154774025680185;
           6.665384753298911  10.077733469087617;
           6.789108218588641  10.031669636291646;
           6.986902969018933   9.966787042536343;
           7.1486795395869205  9.909608504440296;
           7.279932228915664   9.861458156569942;
           7.42034208261618    9.818724722835002;
           7.604706325301207   9.756249646473217;
           7.75436055446275    9.707205077856699;
           7.962310551730733   9.638762797669552;
           8.126461201950661   9.585797415012161;
           8.25059165232358    9.546073378019118;
           8.366582401032703   9.507553099722834;
           8.525306583476764   9.461810269245998;
           8.667751362593231   9.417271197465919;
           8.821824286943695   9.37084050487665 ;
           8.944501219162365   9.333409341591718;
           9.158168387837064   9.269208877764578;
           9.277415017211705   9.237670399909497;
           9.455267498565691   9.186952033486056;
           9.563118545611017   9.157259318966004;
           9.767192494467666   9.100510694690229;
           9.931847030981068   9.057588098874369]
   m_light, m_heavy = minmax(m1,m2)
   ratio = m_heavy/m_light
   interp_e_rad_coef = LinearInterpolation(data[:,1], data[:,2]/100)
   coef = interp_e_rad_coef(m_heavy/m_light)
   ifelse(alg == :naive, 0.1m_light, m_light * coef)
end

# Example
m1 = 28 # M☼ (M☼: solar mass unit)
m2 = 47 # M☼
e_rad        = energy_radiated_black_hole_collapse(m1,m2)
e_rad_approx = energy_radiated_black_hole_collapse(m1,m2; alg=:naive)
m3        = m1 + m2 - e_rad
m3_approx = m1 + m2 - e_rad_approx
@info "\nWhen two black holes with masses $m1 M☼ and $m2 M☼ collapse,\n" *
      "the resulting black hole weights $m3 M☼ (approx.: $m3_approx M☼).\n" *
      "Gravitational waves radiate $e_rad M☼ (approx.: $e_rad_approx M☼)."
